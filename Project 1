setwd("~/Users/gregoirerouaud-jegou/Dossiers/R") 

#Read all 5 csv files
Thales = read.csv('HO.PA.csv', header = TRUE, sep=',')
Safran = read.csv('SAF.PA.csv', header = TRUE, sep=',')
Airbus = read.csv('AIR.PA.csv', header = TRUE, sep=',')
Vinci = read.csv('DG.PA.csv', header = TRUE, sep=',')
SchneiderElectric = read.csv('SU.PA.csv', header = TRUE, sep=',')

#install additional packages and libraries
install.packages('tidyverse')
library(tidyverse)
library(dplyr)

#Calculate prices means for all 5 stocks
ThalesPriceMean <- mean(Thales$Close)
SafranPriceMean <- mean(Safran$Close)
AirbusPriceMean <- mean(Airbus$Close)
VinciPriceMean <- mean(Vinci$Close)
SchneiderElectricPriceMean <- mean(SchneiderElectric$Close)

#Calculate returns means for all 5 stocks

#Calculate daily returns: Rt = [ Pt - Pt-1 ]/ Pt-1
ThalesReturn = diff(Thales$Adj.Close)/Thales$Adj.Close[-length(Thales$Adj.Close)]
#Calculate overall returns mean
ThalesReturnMean <- mean(ThalesReturn)
#Same as Thales for all 4 remaining stock
#For Safran
SafranReturn = diff(Safran$Adj.Close)/Safran$Adj.Close[-length(Safran$Adj.Close)]
SafranReturnMean <- mean(SafranReturn)
#For Airbus
AirbusReturn = diff(Airbus$Adj.Close)/Airbus$Adj.Close[-length(Airbus$Adj.Close)]
AirbusReturnMean <- mean(AirbusReturn)
#For Vinci
VinciReturn = diff(Vinci$Adj.Close)/Vinci$Adj.Close[-length(Vinci$Adj.Close)]
VinciReturnMean <- mean(VinciReturn)
#For Schneider Electric
ReturnSchneiderElectric = diff(SchneiderElectric$Adj.Close)/SchneiderElectric$Adj.Close[-length(SchneiderElectric$Adj.Close)]
SchneiderElectricReturnMean <- mean(ReturnSchneiderElectric)


#Calculate the confidence interval of Prices mean
#For Thales
ThalesPCI <- lm(Thales$Close ~ 1) 
confint(ThalesPCI, level=0.95)
#For Safran
SafranPCI <- lm(Safran$Close ~ 1) 
confint(SafranPCI, level=0.95)
#For Airbus
AirbusPCI <- lm(Airbus$Close ~ 1) 
confint(AirbusPCI, level=0.95)
#For Vinci
VinciPCI <- lm(Vinci$Close ~ 1) 
confint(VinciPCI, level=0.95)
#For SchneiderElectric
SchneiderElectricPCI <- lm(SchneiderElectric$Close ~ 1) 
confint(SchneiderElectricPCI, level=0.95)


#Calculate the confidence interval of Returns mean
#For Thales
ThalesRCI <- lm(Thales$Adj.Close ~ 1) 
confint(ThalesRCI, level=0.95)
#For Safran
SafranRCI <- lm(Safran$Adj.Close ~ 1) 
confint(SafranRCI, level=0.95)
#For Airbus
AirbusRCI <- lm(Airbus$Adj.Close ~ 1) 
confint(AirbusRCI, level=0.95)
#For Vinci
VinciRCI <- lm(Vinci$Adj.Close ~ 1) 
confint(VinciRCI, level=0.95)
#For SchneiderElectric
SchneiderElectricRCI <- lm(SchneiderElectric$Adj.Close ~ 1) 
confint(SchneiderElectricRCI, level=0.95)

#Calculate statistical significance of having the mean value higher/lower by 10% 
#than the existing ones. Explain.

# Assume you have already calculated ThalesPriceMean and ThalesPCI from your previous code
# Define the hypothesized mean values (mean Â± 10%)
Thales_H_mean_high <- ThalesPriceMean * 1.1
Thales_H_mean_low <- ThalesPriceMean * 0.9

# Perform t-test to check statistical significance for mean higher by 10%
Thales_t_test_high <- t.test(Thales$Close, mu = Thales_H_mean_high)

# Perform t-test to check statistical significance for mean lower by 10%
Thales_t_test_low <- t.test(Thales$Close, mu = Thales_H_mean_low)

# Print the results
cat("T-test result for mean higher by 10%:\n")
print(Thales_t_test_high)

cat("\nT-test result for mean lower by 10%:\n")
print(Thales_t_test_low)

#For Safran:
Safran_H_mean_high <- SafranPriceMean * 1.1
Safran_H_mean_low <- SafranPriceMean * 0.9
Safran_t_test_high <- t.test(Safran$Close, mu = Safran_H_mean_high)
Safran_t_test_low <- t.test(Safran$Close, mu = Safran_H_mean_low)
cat("T-test result for mean higher by 10%:\n")
print(Safran_t_test_high)
cat("\nT-test result for mean lower by 10%:\n")
print(Safran_t_test_low)

#For Airbus:
Airbus_H_mean_high <- AirbusPriceMean * 1.1
Airbus_H_mean_low <- AirbusPriceMean * 0.9
Airbus_t_test_high <- t.test(Airbus$Close, mu = Airbus_H_mean_high)
Airbus_t_test_low <- t.test(Airbus$Close, mu = Airbus_H_mean_low)
cat("T-test result for mean higher by 10%:\n")
print(Airbus_t_test_high)
cat("\nT-test result for mean lower by 10%:\n")
print(Airbus_t_test_low)

#For Vinci:
Vinci_H_mean_high <- VinciPriceMean * 1.1
Vinci_H_mean_low <- VinciPriceMean * 0.9
Vinci_t_test_high <- t.test(Vinci$Close, mu = Vinci_H_mean_high)
Vinci_t_test_low <- t.test(Vinci$Close, mu = Vinci_H_mean_low)
cat("T-test result for mean higher by 10%:\n")
print(Vinci_t_test_high)
cat("\nT-test result for mean lower by 10%:\n")
print(Vinci_t_test_low)

#For SchneiderElectric:
SchneiderElectric_H_mean_high <- SchneiderElectricPriceMean * 1.1
SchneiderElectric_H_mean_low <- SchneiderElectricPriceMean * 0.9
SchneiderElectric_t_test_high <- t.test(SchneiderElectric$Close, mu = SchneiderElectric_H_mean_high)
SchneiderElectric_t_test_low <- t.test(SchneiderElectric$Close, mu = SchneiderElectric_H_mean_low)
cat("T-test result for mean higher by 10%:\n")
print(SchneiderElectric_t_test_high)
cat("\nT-test result for mean lower by 10%:\n")
print(SchneiderElectric_t_test_low)

